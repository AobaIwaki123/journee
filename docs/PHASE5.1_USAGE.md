# Phase 5.1 機能確認ガイド

**作成日**: 2025-10-07  
**Phase**: 5.1 - しおりコンポーネントの詳細実装

## 🎯 新機能の確認方法

Phase 5.1で実装したすべての新機能を確認するための手順を説明します。

---

## 🚀 セットアップ

### 1. 環境変数の設定

`.env.local` ファイルに以下を追加（地図機能を確認する場合）:

```env
# Google Maps API（オプション）
NEXT_PUBLIC_GOOGLE_MAPS_API_KEY=your_google_maps_api_key
```

※ Google Maps APIキーがない場合でも、他の機能は確認できます。

### 2. 開発サーバーの起動

```bash
npm run dev
```

ブラウザで `http://localhost:3000` にアクセスしてください。

---

## 📋 モックデータの読み込み

### 方法1: デバッグボタンを使用（推奨）

開発環境では、画面右下に「開発モード」のデバッグパネルが表示されます。

1. **京都サンプル読込** ボタンをクリック
   - 京都2泊3日の旅程データが読み込まれます
   - 17個のスポット（位置情報・画像付き）

2. **東京サンプル読込** ボタンをクリック
   - 東京グルメ旅2日間のデータが読み込まれます
   - 5個のスポット

3. **クリア** ボタン
   - 読み込んだデータをクリアします

### 方法2: ブラウザコンソールから直接読み込み

```javascript
// ブラウザの開発者ツールのコンソールで実行
import { loadSampleItinerary } from '/lib/mock-data/sample-itinerary.ts';
import { useStore } from '/lib/store/useStore.ts';

const kyotoData = loadSampleItinerary('kyoto');
useStore.getState().setItinerary(kyotoData);
```

---

## 🔍 各機能の確認方法

### 1. ✅ しおりヘッダー（ItineraryHeader）

**確認内容**:
- タイトル、目的地、期間、予算が美しく表示される
- ステータスバッジ（作成中/完成/アーカイブ）
- グラデーション背景
- 編集ボタン（右上）

**確認手順**:
1. モックデータを読み込む
2. 右側のしおりプレビューエリアを確認
3. ヘッダー部分にすべての情報が表示されていることを確認

---

### 2. ✅ 日程表コンポーネント（DaySchedule）

**確認内容**:
- Day番号、タイトル、日付
- 統計情報（スポット数、滞在時間、カテゴリ数）
- 予算・移動距離の表示
- 折りたたみ機能

**確認手順**:
1. 各日程カードの右上の「^」アイコンをクリック
2. 日程が折りたたまれる/展開される
3. 「Day 1」のタイトルをクリック（編集モード有効時）
4. タイトルを変更して保存

---

### 3. ✅ 観光スポット詳細カード（SpotCard）

**確認内容**:
- カテゴリアイコン（🏛️観光、🍽️食事、🚗移動、🏨宿泊）
- スポット名、時刻、滞在時間
- 説明文（長い場合は「続きを読む」）
- 位置情報（住所 + Google Mapsリンク）
- 予算
- 画像（京都の清水寺、金閣寺など）
- 編集ボタン（ホバー時表示）

**確認手順**:
1. スポットカードにマウスをホバー
2. 右上に編集ボタンが表示される
3. 画像が表示されているスポットを確認
4. 住所の横の外部リンクアイコンをクリック → Google Mapsが開く
5. 「続きを読む」をクリックして説明文を展開

---

### 4. ✅ 編集モーダル（EditSpotModal）

**確認内容**:
- すべてのフィールドを編集可能
- バリデーション
- 保存/キャンセルボタン

**確認手順**:
1. ヘッダーの「編集」ボタンをクリック（編集モード有効化）
2. 任意のスポットカードにホバーして編集ボタンをクリック
3. モーダルが開く
4. 各フィールドを編集してみる:
   - スポット名
   - カテゴリ（ドロップダウン）
   - 説明
   - 予定時刻・滞在時間
   - 住所、緯度経度
   - 予算
   - 画像URL
   - メモ
5. 「保存」をクリック
6. スポットカードに変更が反映される

---

### 5. ✅ 地図表示（MapView）

**確認内容**:
- Google Maps統合
- 番号付きマーカー
- 情報ウィンドウ（マーカークリック）
- ルート描画
- 日別フィルタ

**確認手順**:

#### Google Maps APIキーがある場合:
1. しおりプレビュー上部の「地図」ボタンをクリック
2. 地図が表示され、すべてのスポットにマーカーが配置される
3. マーカーをクリック → 情報ウィンドウが表示される
4. 「表示」ドロップダウンで「Day 1」を選択
5. Day 1のスポットのみが表示される
6. スポット間のルートが青い線で描画される

#### Google Maps APIキーがない場合:
- フォールバックメッセージが表示される
- 「Google Maps APIキーが設定されていません」

---

### 6. ✅ テンプレート選択（ItineraryTemplates）

**確認内容**:
- 5種類のテンプレート
- 選択状態の視覚化
- プロンプト生成

**確認手順**:
1. テンプレート選択UIを表示（別途実装が必要）
2. または、開発者ツールのコンソールで確認:

```javascript
import { getTemplatePrompt } from '/components/itinerary/ItineraryTemplates.tsx';

console.log(getTemplatePrompt('standard'));
console.log(getTemplatePrompt('photo'));
console.log(getTemplatePrompt('foodie'));
console.log(getTemplatePrompt('adventure'));
console.log(getTemplatePrompt('culture'));
```

---

### 7. ✅ ビューモード切り替え

**確認内容**:
- スケジュール表示 ⇔ 地図表示の切り替え

**確認手順**:
1. しおりプレビュー上部のボタンを確認
2. 「スケジュール」ボタン → スポット一覧が表示
3. 「地図」ボタン → 地図が表示（APIキーがある場合）
4. 切り替えがスムーズに動作することを確認

---

## 🎨 デザイン・アニメーション確認

### グラデーション背景
- ヘッダーのブルーグラデーション
- スポットカードの微細なグラデーション

### ホバーエフェクト
- スポットカードにホバー → 境界線が青に変化、影が強調
- 編集ボタンが表示される

### 折りたたみアニメーション
- 日程カードの展開/折りたたみがスムーズ

### レスポンシブデザイン
- ブラウザウィンドウをリサイズして確認
- モバイルサイズでもレイアウトが崩れない

---

## 🐛 エラーハンドリング確認

### 1. 画像読み込みエラー
- 存在しないURLの画像 → エラーハンドリングで非表示

### 2. Google Maps APIキー未設定
- フォールバックメッセージが表示される

### 3. 位置情報がないスポット
- Google Mapsリンクが表示されない

---

## 📸 スクリーンショット確認ポイント

以下のスクリーンショットを撮影して、実装を確認してください:

1. **しおりヘッダー全体**
   - グラデーション背景、タイトル、メタデータ、ステータスバッジ

2. **日程カード（展開状態）**
   - Day番号、タイトル、統計情報、予算・移動距離

3. **スポットカード（画像付き）**
   - カテゴリアイコン、画像、説明文、位置情報、予算

4. **編集モーダル**
   - すべてのフィールドが表示されている状態

5. **地図表示**
   - マーカー、情報ウィンドウ、ルート描画

6. **ビューモード切り替え**
   - スケジュール ⇔ 地図の切り替えボタン

---

## 🔧 トラブルシューティング

### モックデータが表示されない
- ブラウザのコンソールでエラーを確認
- デバッグボタンが表示されているか確認（開発環境のみ）

### 地図が表示されない
- `.env.local` に `NEXT_PUBLIC_GOOGLE_MAPS_API_KEY` が設定されているか確認
- ブラウザのコンソールでAPIキーエラーを確認

### 画像が表示されない
- `next.config.js` の `remotePatterns` が正しく設定されているか確認
- 外部画像URLにアクセスできるか確認

### 編集ボタンが表示されない
- ヘッダーの「編集」ボタンをクリックして編集モードを有効化

---

## ✅ 動作確認チェックリスト

- [ ] モックデータを読み込める
- [ ] しおりヘッダーが表示される
- [ ] 日程カードが表示される
- [ ] スポットカードが表示される
- [ ] カテゴリアイコンが表示される
- [ ] 画像が表示される（一部スポット）
- [ ] Google Mapsリンクが機能する
- [ ] 編集ボタンが表示される（ホバー時）
- [ ] 編集モーダルが開く
- [ ] 編集内容が保存される
- [ ] 日程カードの折りたたみが機能する
- [ ] ビューモードの切り替えが機能する
- [ ] 地図が表示される（APIキーがある場合）
- [ ] マーカーが表示される
- [ ] 情報ウィンドウが表示される
- [ ] ルートが描画される
- [ ] 日別フィルタが機能する
- [ ] デバッグボタンでデータをクリアできる

---

## 📝 フィードバック

Phase 5.1の機能を確認した後、以下の点についてフィードバックをお願いします:

1. **UI/UX**: デザインの見やすさ、使いやすさ
2. **パフォーマンス**: 動作速度、レスポンシブ性
3. **バグ**: 発見したバグや不具合
4. **改善提案**: より良いUXのためのアイデア

---

**最終更新**: 2025-10-07