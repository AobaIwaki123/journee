---
alwaysApply: true
---

# Journee ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦
AIã¨ã¨ã‚‚ã«æ—…ã®ã—ãŠã‚Šã‚’ä½œæˆã™ã‚‹Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€‚ãƒãƒ£ãƒƒãƒˆå½¢å¼ã§æ—…è¡Œè¨ˆç”»ã‚’ç«‹ã¦ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ã—ãŠã‚Šã‚’ç”Ÿæˆã—ã¾ã™ã€‚

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
- **ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: Next.js 14+ (App Router)
- **è¨€èª**: TypeScript
- **ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°**: Tailwind CSS
- **çŠ¶æ…‹ç®¡ç†**: Zustand
- **èªè¨¼**: NextAuth.js (Google OAuth)
- **UI**: lucide-react (ã‚¢ã‚¤ã‚³ãƒ³)
- **é–‹ç™ºç’°å¢ƒ**: Docker

## ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

### `/app` - Next.js App Router
- [app/page.tsx](mdc:app/page.tsx) - ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ï¼ˆèªè¨¼ä¿è­·ã€ãƒãƒ£ãƒƒãƒˆ40% / ã—ãŠã‚Š60%ï¼‰
- [app/layout.tsx](mdc:app/layout.tsx) - ãƒ«ãƒ¼ãƒˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆAuthProviderçµ±åˆæ¸ˆã¿ï¼‰
- [app/globals.css](mdc:app/globals.css) - ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ã‚¿ã‚¤ãƒ«
- `/app/login` - ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸
  - [page.tsx](mdc:app/login/page.tsx) - Googleãƒ­ã‚°ã‚¤ãƒ³ç”»é¢
- `/app/privacy` - ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ï¼ˆPhase 2å®Ÿè£…æ¸ˆã¿ï¼‰
- `/app/terms` - åˆ©ç”¨è¦ç´„ï¼ˆPhase 2å®Ÿè£…æ¸ˆã¿ï¼‰
- `/app/api` - APIãƒ«ãƒ¼ãƒˆ
  - `/auth/[...nextauth]` - NextAuth.jsèªè¨¼ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
    - [route.ts](mdc:app/api/auth/[...nextauth]/route.ts) - èªè¨¼API
  - `/chat` - ãƒãƒ£ãƒƒãƒˆAPIï¼ˆPhase 3å®Ÿè£…æ¸ˆã¿ï¼‰
    - [route.ts](mdc:app/api/chat/route.ts) - AIãƒãƒ£ãƒƒãƒˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å¯¾å¿œï¼‰
  - `/health` - ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
    - [route.ts](mdc:app/api/health/route.ts) - ã‚µãƒ¼ãƒ“ã‚¹ç¨¼åƒçŠ¶æ³ç¢ºèª
  - `/user/me` - ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±
    - [route.ts](mdc:app/api/user/me/route.ts) - ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å–å¾—ï¼ˆèªè¨¼å¿…é ˆï¼‰

### `/components` - Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- `/auth` - èªè¨¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆPhase 2å®Ÿè£…æ¸ˆã¿ï¼‰
  - [AuthProvider.tsx](mdc:components/auth/AuthProvider.tsx) - NextAuthã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼
  - [LoginButton.tsx](mdc:components/auth/LoginButton.tsx) - Googleãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³
  - [UserMenu.tsx](mdc:components/auth/UserMenu.tsx) - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼ˆãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ï¼‰
- `/chat` - ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½
  - [ChatBox.tsx](mdc:components/chat/ChatBox.tsx) - ãƒãƒ£ãƒƒãƒˆã‚³ãƒ³ãƒ†ãƒŠ
  - [MessageList.tsx](mdc:components/chat/MessageList.tsx) - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¸€è¦§
  - [MessageInput.tsx](mdc:components/chat/MessageInput.tsx) - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å…¥åŠ›
  - [AISelector.tsx](mdc:components/chat/AISelector.tsx) - AIãƒ¢ãƒ‡ãƒ«é¸æŠ
- `/itinerary` - ã—ãŠã‚Šæ©Ÿèƒ½ï¼ˆPhase 5.1å®Ÿè£…æ¸ˆã¿ï¼‰
  - [ItineraryPreview.tsx](mdc:components/itinerary/ItineraryPreview.tsx) - ã—ãŠã‚Šãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆï¼‰
  - [ItineraryHeader.tsx](mdc:components/itinerary/ItineraryHeader.tsx) - ã‚¿ã‚¤ãƒˆãƒ«ãƒ»ã‚µãƒãƒªãƒ¼ï¼ˆã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³èƒŒæ™¯ï¼‰
  - [DaySchedule.tsx](mdc:components/itinerary/DaySchedule.tsx) - æ—¥ç¨‹è¡¨ç¤ºï¼ˆæŠ˜ã‚ŠãŸãŸã¿ã€çµ±è¨ˆæƒ…å ±ï¼‰
  - [SpotCard.tsx](mdc:components/itinerary/SpotCard.tsx) - è¦³å…‰ã‚¹ãƒãƒƒãƒˆã‚«ãƒ¼ãƒ‰ï¼ˆç”»åƒã€ã‚«ãƒ†ã‚´ãƒªã‚¢ã‚¤ã‚³ãƒ³ï¼‰
  - [EditSpotModal.tsx](mdc:components/itinerary/EditSpotModal.tsx) - ã‚¹ãƒãƒƒãƒˆç·¨é›†ãƒ¢ãƒ¼ãƒ€ãƒ«
  - [MapView.tsx](mdc:components/itinerary/MapView.tsx) - åœ°å›³è¡¨ç¤ºï¼ˆGoogle Maps APIçµ±åˆï¼‰
  - [ItineraryTemplates.tsx](mdc:components/itinerary/ItineraryTemplates.tsx) - ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé¸æŠUI
- `/layout` - ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
  - [Header.tsx](mdc:components/layout/Header.tsx) - ãƒ˜ãƒƒãƒ€ãƒ¼ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆèªè¨¼æ©Ÿèƒ½çµ±åˆæ¸ˆã¿ï¼‰
- `/settings` - è¨­å®šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆPhase 3.6äºˆå®šï¼‰
  - SoundSettings.tsx - åŠ¹æœéŸ³è¨­å®šUIï¼ˆéŸ³é‡èª¿æ•´ã€ON/OFFï¼‰
- `/sound` - ã‚µã‚¦ãƒ³ãƒ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆPhase 3.6äºˆå®šï¼‰
  - SoundProvider.tsx - ã‚°ãƒ­ãƒ¼ãƒãƒ«éŸ³å£°ç®¡ç†ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼
- `/ui` - å…±é€šUIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
  - [LoadingSpinner.tsx](mdc:components/ui/LoadingSpinner.tsx) - ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ãƒ”ãƒŠãƒ¼
  - [ErrorNotification.tsx](mdc:components/ui/ErrorNotification.tsx) - ã‚¨ãƒ©ãƒ¼é€šçŸ¥ï¼ˆPhase 3å®Ÿè£…æ¸ˆã¿ï¼‰

### `/lib` - ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ»ãƒ­ã‚¸ãƒƒã‚¯
- `/auth` - èªè¨¼ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆPhase 2å®Ÿè£…æ¸ˆã¿ï¼‰
  - [auth-options.ts](mdc:lib/auth/auth-options.ts) - NextAuthè¨­å®šï¼ˆGoogle OAuth, JWTæˆ¦ç•¥ï¼‰
  - [session.ts](mdc:lib/auth/session.ts) - ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ãƒ˜ãƒ«ãƒ‘ãƒ¼ï¼ˆgetSession, getCurrentUserï¼‰
  - [README.md](mdc:lib/auth/README.md) - èªè¨¼æ©Ÿèƒ½ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- `/store` - ZustandçŠ¶æ…‹ç®¡ç†
  - [useStore.ts](mdc:lib/store/useStore.ts) - ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ãƒˆã‚¢
- `/ai` - AIçµ±åˆï¼ˆPhase 3å®Ÿè£…æ¸ˆã¿ï¼‰
  - [gemini.ts](mdc:lib/ai/gemini.ts) - Google Gemini APIçµ±åˆï¼ˆgemini-2.5-proä½¿ç”¨ï¼‰
  - [prompts.ts](mdc:lib/ai/prompts.ts) - ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç®¡ç†ã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ‘ãƒ¼ã‚¹å‡¦ç†
  - [test-client.ts](mdc:lib/ai/test-client.ts) - APIãƒ†ã‚¹ãƒˆç”¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
- `/sound` - ã‚µã‚¦ãƒ³ãƒ‰ç®¡ç†ï¼ˆPhase 3.6äºˆå®šï¼‰
  - SoundManager.ts - åŠ¹æœéŸ³å†ç”Ÿãƒ»éŸ³é‡åˆ¶å¾¡ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
- `/utils` - ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
  - [api-client.ts](mdc:lib/utils/api-client.ts) - APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ˜ãƒ«ãƒ‘ãƒ¼
- `/mock-data` - ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ï¼ˆPhase 5.1å®Ÿè£…æ¸ˆã¿ï¼‰
  - [sample-itinerary.ts](mdc:lib/mock-data/sample-itinerary.ts) - äº¬éƒ½ãƒ»æ±äº¬ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ï¼ˆä½ç½®æƒ…å ±ãƒ»ç”»åƒä»˜ãï¼‰

### `/types` - TypeScriptå‹å®šç¾©
- [chat.ts](mdc:types/chat.ts) - ãƒãƒ£ãƒƒãƒˆé–¢é€£ã®å‹
- [itinerary.ts](mdc:types/itinerary.ts) - ã—ãŠã‚Šé–¢é€£ã®å‹
- [auth.ts](mdc:types/auth.ts) - èªè¨¼é–¢é€£ã®å‹ï¼ˆNextAuthæ‹¡å¼µå‹å®šç¾©ï¼‰
- [api.ts](mdc:types/api.ts) - APIå…±é€šå‹å®šç¾©ï¼ˆãƒ¬ã‚¹ãƒãƒ³ã‚¹ã€ã‚¨ãƒ©ãƒ¼ï¼‰

### `/public` - é™çš„ãƒ•ã‚¡ã‚¤ãƒ«
- `/images` - ç”»åƒãƒ»ã‚¢ã‚¤ã‚³ãƒ³
- `/sounds` - åŠ¹æœéŸ³ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆPhase 3.6äºˆå®šï¼‰
  - notification.mp3 - AIè¿”ä¿¡é€šçŸ¥éŸ³
  - send.mp3 - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡éŸ³
  - update.mp3 - ã—ãŠã‚Šæ›´æ–°éŸ³
  - error.mp3 - ã‚¨ãƒ©ãƒ¼é€šçŸ¥éŸ³
  - success.mp3 - æˆåŠŸé€šçŸ¥éŸ³

### `/docs` - ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [API.md](mdc:docs/API.md) - APIä»•æ§˜æ›¸
- [PHASE2_IMPLEMENTATION.md](mdc:docs/PHASE2_IMPLEMENTATION.md) - Phase 2å®Ÿè£…ãƒ¬ãƒãƒ¼ãƒˆ
- [PHASE2_TESTING_GUIDE.md](mdc:docs/PHASE2_TESTING_GUIDE.md) - Phase 2ãƒ†ã‚¹ãƒˆã‚¬ã‚¤ãƒ‰
- [PHASE3_INTEGRATION_COMPLETE.md](mdc:docs/PHASE3_INTEGRATION_COMPLETE.md) - Phase 3çµ±åˆãƒ¬ãƒãƒ¼ãƒˆ
- [PHASE3_TESTING_GUIDE.md](mdc:docs/PHASE3_TESTING_GUIDE.md) - Phase 3ãƒ†ã‚¹ãƒˆã‚¬ã‚¤ãƒ‰
- [PHASE3.5.1_MARKDOWN_RENDERING.md](mdc:docs/PHASE3.5.1_MARKDOWN_RENDERING.md) - ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°å®Ÿè£…ãƒ¬ãƒãƒ¼ãƒˆ
- [PHASE5.1_IMPLEMENTATION.md](mdc:docs/PHASE5.1_IMPLEMENTATION.md) - Phase 5.1å®Ÿè£…ãƒ¬ãƒãƒ¼ãƒˆ
- [PHASE5.1_USAGE.md](mdc:docs/PHASE5.1_USAGE.md) - Phase 5.1æ©Ÿèƒ½ç¢ºèªã‚¬ã‚¤ãƒ‰
- [PHASE6_1_IMPLEMENTATION.md](mdc:docs/PHASE6_1_IMPLEMENTATION.md) - Phase 6.1å®Ÿè£…ãƒ¬ãƒãƒ¼ãƒˆï¼ˆAPIã‚­ãƒ¼ç®¡ç†ï¼‰
- [PHASE6_2_IMPLEMENTATION.md](mdc:docs/PHASE6_2_IMPLEMENTATION.md) - Phase 6.2å®Ÿè£…ãƒ¬ãƒãƒ¼ãƒˆï¼ˆClaude APIçµ±åˆï¼‰
- [PHASE6_3_IMPLEMENTATION.md](mdc:docs/PHASE6_3_IMPLEMENTATION.md) - Phase 6.3å®Ÿè£…ãƒ¬ãƒãƒ¼ãƒˆï¼ˆãƒ¢ãƒ‡ãƒ«è¨­å®šä¸€å…ƒç®¡ç†ï¼‰
- [INTEGRATION_COMPLETE.md](mdc:docs/INTEGRATION_COMPLETE.md) - Phase 1 & 2çµ±åˆãƒ¬ãƒãƒ¼ãƒˆ

### ãã®ä»–
- [middleware.ts](mdc:middleware.ts) - èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ï¼ˆä¿è­·ã•ã‚ŒãŸãƒ«ãƒ¼ãƒˆè‡ªå‹•ãƒã‚§ãƒƒã‚¯ï¼‰

## é–‹ç™ºãƒ•ã‚§ãƒ¼ã‚º
- âœ… **Phase 1ï¼ˆå®Œäº†ï¼‰**: åŸºç¤æ§‹ç¯‰ï¼ˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã€ãƒãƒ£ãƒƒãƒˆUIã€çŠ¶æ…‹ç®¡ç†ï¼‰
- âœ… **Phase 2ï¼ˆå®Œäº†ï¼‰**: èªè¨¼æ©Ÿèƒ½ï¼ˆNextAuth.js + Google OAuthï¼‰
- âœ… **Phase 3ï¼ˆå®Œäº†ï¼‰**: AIçµ±åˆï¼ˆGemini APIã€ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°å¯¾å¿œï¼‰
- âœ… **Phase 3.5.1ï¼ˆå®Œäº†ï¼‰**: ãƒãƒ¼ã‚¯ãƒ€ã‚¦ãƒ³ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æ©Ÿèƒ½
- âœ… **Phase 5.1ï¼ˆå®Œäº†ï¼‰**: ã—ãŠã‚Šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè©³ç´°å®Ÿè£…ï¼ˆãƒ˜ãƒƒãƒ€ãƒ¼ã€åœ°å›³ã€ç·¨é›†ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼‰
- âœ… **Phase 6ï¼ˆå®Œäº†ï¼‰**: Claude APIçµ±åˆãƒ»ãƒ¢ãƒ‡ãƒ«åˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½
- âœ… **BUG-001ï¼ˆå®Œäº†ï¼‰**: JSONå‰Šé™¤ãƒã‚°ä¿®æ­£
- ğŸ”„ **Phase 3.6ï¼ˆæ¬¡ï¼‰**: åŠ¹æœéŸ³ã‚·ã‚¹ãƒ†ãƒ ï¼ˆAIè¿”ä¿¡éŸ³ã€éŸ³é‡è¨­å®šã€UXå‘ä¸Šï¼‰
- ğŸ”„ **Phase 4ï¼ˆæ¬¡ï¼‰**: æ®µéšçš„æ—…ç¨‹æ§‹ç¯‰ã‚·ã‚¹ãƒ†ãƒ 
- ğŸ“‹ **Phase 5.2-10**: ãã®ä»–æ©Ÿèƒ½ï¼ˆä¸€æ™‚ä¿å­˜ã€PDFå‡ºåŠ›ã€ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œã€DBçµ±åˆãªã©ï¼‰
- ğŸ“‹ è©³ç´°ã¯[README.md](mdc:README.md)å‚ç…§

## èªè¨¼ã‚·ã‚¹ãƒ†ãƒ ï¼ˆPhase 2å®Ÿè£…æ¸ˆã¿ï¼‰
### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
- **èªè¨¼æˆ¦ç•¥**: JWTï¼ˆJSON Web Tokenï¼‰
- **ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼**: Google OAuth 2.0
- **ã‚»ãƒƒã‚·ãƒ§ãƒ³æœŸé™**: 30æ—¥é–“
- **ä¿å­˜**: HTTPOnly Cookieï¼ˆXSSå¯¾ç­–ï¼‰

### èªè¨¼ãƒ•ãƒ­ãƒ¼
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ `/api/auth/signin` ã«ã‚¢ã‚¯ã‚»ã‚¹
2. Google OAuthç”»é¢ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
3. èªè¨¼æˆåŠŸå¾Œã€JWTãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç”Ÿæˆã—ã¦Cookieã«ä¿å­˜
4. ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ

### ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ãƒ˜ãƒ«ãƒ‘ãƒ¼
```typescript
import { getCurrentUser } from '@/lib/auth/session'

// Server Component / Route Handler
const user = await getCurrentUser()
if (!user) {
  return new Response('Unauthorized', { status: 401 })
}
```

### èªè¨¼ä¿è­·
- **ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢**: `/api/*`ï¼ˆä¸€éƒ¨é™¤å¤–ï¼‰ã€ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã¯è‡ªå‹•èªè¨¼ãƒã‚§ãƒƒã‚¯
- **æœªèªè¨¼æ™‚**: è‡ªå‹•çš„ã« `/login` ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ

### APIä¸€è¦§
| ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | èª¬æ˜ | èªè¨¼ | Phase |
|------------|------|------|-------|
| `GET /api/health` | ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ | ä¸è¦ | 2 |
| `GET /api/auth/signin` | ã‚µã‚¤ãƒ³ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ | ä¸è¦ | 2 |
| `GET /api/auth/signout` | ã‚µã‚¤ãƒ³ã‚¢ã‚¦ãƒˆ | å¿…è¦ | 2 |
| `GET /api/auth/session` | ã‚»ãƒƒã‚·ãƒ§ãƒ³æƒ…å ±å–å¾— | ä¸è¦ | 2 |
| `GET /api/user/me` | ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾— | å¿…è¦ | 2 |
| `POST /api/chat` | AIãƒãƒ£ãƒƒãƒˆ | ä¸è¦ | 3 |

è©³ç´°ã¯ [docs/API.md](mdc:docs/API.md) ã¨ [PHASE3_API_DOCUMENTATION.md](mdc:PHASE3_API_DOCUMENTATION.md) å‚ç…§ã€‚

## é‡è¦ãªãƒ•ã‚¡ã‚¤ãƒ«
- [package.json](mdc:package.json) - ä¾å­˜é–¢ä¿‚ãƒ»npm scripts
- [tsconfig.json](mdc:tsconfig.json) - TypeScriptè¨­å®š
- [tailwind.config.ts](mdc:tailwind.config.ts) - Tailwind CSSè¨­å®š
- [README.md](mdc:README.md) - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®è©³ç´°
- [PHASE1_SUMMARY.md](mdc:PHASE1_SUMMARY.md) - Phase 1å®Œäº†ã‚µãƒãƒªãƒ¼
- [docs/INTEGRATION_COMPLETE.md](mdc:docs/INTEGRATION_COMPLETE.md) - Phase 1 & 2çµ±åˆãƒ¬ãƒãƒ¼ãƒˆ

## çŠ¶æ…‹ç®¡ç†ï¼ˆZustandï¼‰
### ä¸»è¦ãªçŠ¶æ…‹
- **ãƒãƒ£ãƒƒãƒˆçŠ¶æ…‹**: `messages`, `isLoading`, `isStreaming`, `streamingMessage`
- **ã—ãŠã‚ŠçŠ¶æ…‹**: `currentItinerary`ï¼ˆ`ItineraryData`å‹ï¼‰
- **UIçŠ¶æ…‹**: `selectedAI`ï¼ˆgemini / claudeï¼‰
- **ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆçŠ¶æ…‹**: `selectedTemplate`ï¼ˆPhase 5.1å®Ÿè£…æ¸ˆã¿ï¼‰
- **ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹**: `error`, `setError`
- **APIã‚­ãƒ¼ç®¡ç†**: `claudeApiKey`, `setClaudeApiKey`ï¼ˆPhase 6å®Ÿè£…æ¸ˆã¿ï¼‰
- **åŠ¹æœéŸ³è¨­å®š**: `soundEnabled`, `soundVolume`ï¼ˆPhase 3.6ç”¨ï¼‰

### ä¸»è¦ãªæ“ä½œ
- `addMessage(message)` - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¿½åŠ 
- `setItinerary(itinerary)` - ã—ãŠã‚Šè¨­å®š
- `updateItinerary(updates)` - ã—ãŠã‚Šéƒ¨åˆ†æ›´æ–°ï¼ˆPhase 5.1å®Ÿè£…æ¸ˆã¿ï¼‰
- `setStreaming(streaming)` - ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°çŠ¶æ…‹è¨­å®š
- `appendStreamingMessage(chunk)` - ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¿½åŠ 
- `setSelectedTemplate(template)` - ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé¸æŠï¼ˆPhase 5.1å®Ÿè£…æ¸ˆã¿ï¼‰
- `setError(error)` - ã‚¨ãƒ©ãƒ¼è¨­å®š
- `setSoundEnabled(enabled)` - åŠ¹æœéŸ³ON/OFFåˆ‡ã‚Šæ›¿ãˆï¼ˆPhase 3.6ç”¨ï¼‰
- `setSoundVolume(volume)` - éŸ³é‡èª¿æ•´ï¼ˆ0.0 - 1.0ï¼‰ï¼ˆPhase 3.6ç”¨ï¼‰

å…¨ã¦ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰ `useStore()` ã§ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã€‚

## ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆåŸå‰‡
1. **Client Components**: 'use client'ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–å¿…é ˆï¼ˆã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªUIï¼‰
2. **Server Components**: èªè¨¼ãƒã‚§ãƒƒã‚¯ãªã©ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰å‡¦ç†ãŒå¿…è¦ãªå ´åˆ
3. **ãƒ•ã‚¡ã‚¤ãƒ«å‘½å**: PascalCaseï¼ˆä¾‹: ChatBox.tsxï¼‰
4. **export**: named exportï¼ˆä¾‹: `export const ChatBox: React.FC = () => {}`ï¼‰
5. **å‹å®‰å…¨æ€§**: ã™ã¹ã¦ã®propsã¨stateã«å‹å®šç¾©
6. **å†åˆ©ç”¨æ€§**: å˜ä¸€è²¬ä»»ã®åŸå‰‡ã«å¾“ã†

## Dockerç’°å¢ƒ
- `npm run docker:start` - é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
- `npm run docker:stop` - åœæ­¢
- `npm run docker:logs` - ãƒ­ã‚°ç¢ºèª
- è©³ç´°ã¯[DOCKER.md](mdc:DOCKER.md)å‚ç…§

## AIçµ±åˆã‚·ã‚¹ãƒ†ãƒ ï¼ˆPhase 3å®Ÿè£…æ¸ˆã¿ï¼‰
### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
- **AIãƒ¢ãƒ‡ãƒ«**: Google Gemini 2.5 Pro
- **é€šä¿¡æ–¹å¼**: Server-Sent Eventsï¼ˆSSEï¼‰ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°
- **ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼**: ãƒ†ã‚­ã‚¹ãƒˆ + JSONï¼ˆã—ãŠã‚Šãƒ‡ãƒ¼ã‚¿ï¼‰
- **ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç®¡ç†**: ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ + ä¼šè©±å±¥æ­´ + ç¾åœ¨ã®ã—ãŠã‚Š

### AIçµ±åˆãƒ•ãƒ­ãƒ¼
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å…¥åŠ›
2. ãƒãƒ£ãƒƒãƒˆå±¥æ­´ï¼ˆæœ€æ–°10ä»¶ï¼‰ã‚’æº–å‚™
3. Gemini APIã«ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
4. ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¡¨ç¤º
5. ã—ãŠã‚Šãƒ‡ãƒ¼ã‚¿ï¼ˆJSONï¼‰ã‚’æŠ½å‡ºã—ã¦ãƒãƒ¼ã‚¸
6. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å±¥æ­´ã«è¿½åŠ 

### ä¸»è¦ãªAIæ©Ÿèƒ½
- **ã—ãŠã‚Šç”Ÿæˆ**: æ—…è¡Œå…ˆã€æœŸé–“ã€äºˆç®—ã‹ã‚‰è‡ªå‹•ç”Ÿæˆ
- **ã—ãŠã‚Šæ›´æ–°**: æ—¢å­˜ã®ã—ãŠã‚Šã«è¦³å…‰ã‚¹ãƒãƒƒãƒˆè¿½åŠ ãƒ»å¤‰æ›´
- **ææ¡ˆ**: è¦³å…‰ã‚¹ãƒãƒƒãƒˆã€ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã€ç§»å‹•æ‰‹æ®µã®ææ¡ˆ
- **æœ€é©åŒ–**: ç§»å‹•æ™‚é–“ã€æ»åœ¨æ™‚é–“ã€äºˆç®—ã‚’è€ƒæ…®ã—ãŸæœ€é©åŒ–

### ã—ãŠã‚Šãƒ‡ãƒ¼ã‚¿æ§‹é€ 
```typescript
interface ItineraryData {
  id: string;
  title: string;
  destination: string;
  startDate?: string;
  endDate?: string;
  duration?: number;
  summary?: string;
  schedule: DaySchedule[];
  totalBudget?: number;
  status: 'draft' | 'completed' | 'archived';
  createdAt: Date;
  updatedAt: Date;
}

interface DaySchedule {
  day: number;
  date?: string;
  title?: string;
  spots: TouristSpot[];
  totalDistance?: number;
  totalCost?: number;
}

interface TouristSpot {
  id: string;
  name: string;
  description: string;
  location?: Location;
  scheduledTime?: string;
  duration?: number;
  category?: 'sightseeing' | 'dining' | 'transportation' | 'accommodation' | 'other';
  estimatedCost?: number;
  notes?: string;
  imageUrl?: string;
}
```

### ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ¬ã‚¹ãƒãƒ³ã‚¹
```typescript
// Server-Sent Eventså½¢å¼
data: {"type":"message","content":"ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ£ãƒ³ã‚¯"}
data: {"type":"itinerary","itinerary":{...}}
data: {"type":"done"}
data: {"type":"error","error":"ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"}
```

### AIåˆ©ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³
```typescript
// ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆMessageInput.tsxï¼‰
import { sendChatMessageStream } from '@/lib/utils/api-client';

const handleSend = async (message: string) => {
  const history = messages.slice(-10);
  
  for await (const chunk of sendChatMessageStream(
    message,
    history,
    currentItinerary
  )) {
    if (chunk.type === 'message') {
      appendStreamingMessage(chunk.content);
    } else if (chunk.type === 'itinerary') {
      setItinerary(chunk.itinerary);
    }
  }
};
```

è©³ç´°ã¯ [lib/ai/README.md](mdc:lib/ai/README.md)ï¼ˆæœªä½œæˆï¼‰ãŠã‚ˆã³ [PHASE3_API_DOCUMENTATION.md](mdc:PHASE3_API_DOCUMENTATION.md) å‚ç…§ã€‚

## ç’°å¢ƒå¤‰æ•°ï¼ˆ`.env.local`ï¼‰
```env
# èªè¨¼ï¼ˆPhase 2ï¼‰
NEXTAUTH_URL=http://localhost:3000
NEXTAUTH_SECRET=your_secret_here
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret

# AIçµ±åˆï¼ˆPhase 3å®Ÿè£…æ¸ˆã¿ï¼‰
GEMINI_API_KEY=your_gemini_api_key

# Google Mapsï¼ˆPhase 5.1å®Ÿè£…æ¸ˆã¿ï¼‰
NEXT_PUBLIC_GOOGLE_MAPS_API_KEY=your_google_maps_api_key
```

`.env.example` ã‚’å‚ç…§ã—ã¦è¨­å®šã€‚
